<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Finance Master Pro - Sant√© & Strat√©gie</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        :root { 
            --primary: #2563eb; --secondary: #64748b; 
            --danger: #ef4444; --success: #22c55e; --warning: #f59e0b;
        }
        body { font-family: 'Segoe UI', system-ui, sans-serif; background: #f8fafc; padding: 20px; color: #1e293b; }
        .container { max-width: 1200px; margin: auto; background: white; padding: 30px; border-radius: 20px; box-shadow: 0 10px 40px rgba(0,0,0,0.05); }
        
        .grid-main { display: grid; grid-template-columns: 1fr 1fr; gap: 40px; }
        .panel { background: #ffffff; border: 1px solid #e2e8f0; padding: 20px; border-radius: 15px; }
        .section-title { border-bottom: 2px solid #f1f5f9; padding-bottom: 10px; margin-bottom: 20px; font-size: 1.1rem; color: var(--primary); display: flex; align-items: center; gap: 10px; }
        
        label { display: block; margin-bottom: 5px; font-size: 0.85rem; font-weight: 600; color: #475569; }
        input { width: 100%; padding: 10px; margin-bottom: 15px; border: 1px solid #cbd5e1; border-radius: 8px; box-sizing: border-box; }
        
        .result-box { background: #1e293b; color: white; padding: 25px; border-radius: 12px; text-align: center; position: sticky; top: 20px; }
        .big-val { font-size: 2.5rem; font-weight: 800; color: #38bdf8; line-height: 1; }
        
        /* Jauge d'endettement */
        .gauge-container { height: 12px; background: #e2e8f0; border-radius: 10px; margin: 15px 0; overflow: hidden; }
        .gauge-bar { height: 100%; width: 0%; transition: 0.5s ease; }
        
        .info-card { font-size: 0.9rem; padding: 12px; border-radius: 8px; margin-top: 10px; }
        .success-bg { background: #f0fdf4; color: #166534; border: 1px solid #bbf7d0; }
        .warning-bg { background: #fffbeb; color: #92400e; border: 1px solid #fde68a; }
        .danger-bg { background: #fef2f2; color: #991b1b; border: 1px solid #fecaca; }

        @media (max-width: 900px) { .grid-main { grid-template-columns: 1fr; } }
    </style>
</head>
<body>

<div class="container">
    <div style="text-align: center; margin-bottom: 30px;">
        <h1 style="margin:0;">üè¶ Finance Master Pro</h1>
        <p style="color: var(--secondary);">Analyse de sant√© financi√®re & co√ªt r√©el</p>
    </div>

    <div class="grid-main">
        <div class="inputs">
            
            <div class="panel">
                <div class="section-title">üì¶ Le Pr√™t & Vrai Co√ªt</div>
                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px;">
                    <div>
                        <label>Montant (‚Ç¨)</label>
                        <input type="number" id="p-cap" value="15000" oninput="run()">
                    </div>
                    <div>
                        <label>Taux annuel (%)</label>
                        <input type="number" id="p-rate" value="4.5" step="0.1" oninput="run()">
                    </div>
                </div>
                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px;">
                    <div>
                        <label>Dur√©e (mois)</label>
                        <input type="number" id="p-dur" value="48" oninput="run()">
                    </div>
                    <div>
                        <label>Assurance/Frais (‚Ç¨/mois)</label>
                        <input type="number" id="p-extra" value="40" oninput="run()">
                    </div>
                </div>
            </div>

            <div class="panel" style="margin-top:20px;">
                <div class="section-title">ü•ó Sant√© Financi√®re</div>
                <label>Tes revenus mensuels nets (‚Ç¨)</label>
                <input type="number" id="user-income" value="2000" oninput="run()">
                <div id="gauge-label" style="font-weight:bold; font-size:0.9rem;">Taux d'endettement : 0%</div>
                <div class="gauge-container">
                    <div id="gauge-bar" class="gauge-bar"></div>
                </div>
                <div id="debt-msg" class="info-card"></div>
            </div>

            <div class="panel" style="margin-top:20px;">
                <div class="section-title">‚ö° Remboursement Anticip√©</div>
                <label>Mensualit√© augment√©e de (‚Ç¨)</label>
                <input type="number" id="p-boost" value="0" placeholder="Ex: 50" oninput="run()">
                <div id="boost-msg" style="font-size: 0.85rem; color: var(--success); font-weight: 600;"></div>
            </div>

        </div>

        <div class="results">
            <div class="result-box">
                <span style="font-size: 0.9rem; opacity: 0.8; text-transform: uppercase;">Mensualit√© Totale</span>
                <span class="big-val" id="res-m-total">0 ‚Ç¨</span>
                <p id="res-detail" style="font-size: 0.9rem; margin-top: 10px; opacity: 0.7;"></p>
                <hr style="opacity:0.1; margin: 20px 0;">
                <div style="display:grid; grid-template-columns: 1fr 1fr;">
                    <div>
                        <small>Co√ªt total Int√©r√™ts</small><br>
                        <strong id="res-int">0 ‚Ç¨</strong>
                    </div>
                    <div>
                        <small>Co√ªt Vrai (avec frais)</small><br>
                        <strong id="res-vrai">0 ‚Ç¨</strong>
                    </div>
                </div>
            </div>
            
            <div style="margin-top: 30px; height: 300px;">
                <canvas id="mainChart"></canvas>
            </div>
        </div>
    </div>
</div>

<script>
let chart;

function run() {
    // Inputs
    const P = parseFloat(document.getElementById('p-cap').value) || 0;
    const annualRate = parseFloat(document.getElementById('p-rate').value) / 100;
    const n_base = parseInt(document.getElementById('p-dur').value) || 0;
    const extra = parseFloat(document.getElementById('p-extra').value) || 0;
    const income = parseFloat(document.getElementById('user-income').value) || 0;
    const boost = parseFloat(document.getElementById('p-boost').value) || 0;

    if (P <= 0 || n_base <= 0) return;

    // Calcul mensualit√© de base (hors assurance et boost)
    const r = annualRate / 12;
    const m_base = r === 0 ? P / n_base : (P * r) / (1 - Math.pow(1 + r, -n_base));
    
    // Calcul de la nouvelle dur√©e si boost
    let m_boosted = m_base + boost;
    let n_new = n_base;
    let total_int_boosted = 0;

    if (boost > 0 && r > 0) {
        n_new = -Math.log(1 - (P * r) / m_boosted) / Math.log(1 + r);
        total_int_boosted = (m_boosted * n_new) - P;
    } else {
        total_int_boosted = (m_base * n_base) - P;
    }

    const m_total = m_boosted + extra;
    const total_cost_vrai = (m_total * n_new);

    // 1. Affichage des prix
    document.getElementById('res-m-total').innerText = Math.round(m_total) + " ‚Ç¨";
    document.getElementById('res-int').innerText = Math.round(total_int_boosted) + " ‚Ç¨";
    document.getElementById('res-vrai').innerText = Math.round(total_cost_vrai) + " ‚Ç¨";
    document.getElementById('res-detail').innerText = `Dont pr√™t: ${Math.round(m_boosted)}‚Ç¨ + Frais: ${extra}‚Ç¨`;

    // 2. Sant√© Financi√®re (Ratio d'endettement)
    const ratio = income > 0 ? (m_total / income) * 100 : 0;
    const gBar = document.getElementById('gauge-bar');
    const gMsg = document.getElementById('debt-msg');
    document.getElementById('gauge-label').innerText = `Taux d'endettement : ${ratio.toFixed(1)}%`;
    
    gBar.style.width = Math.min(ratio, 100) + "%";
    if (ratio < 20) { gBar.style.background = var(--success); gMsg.className="info-card success-bg"; gMsg.innerText="‚úÖ Tr√®s sain. Ton budget respire."; }
    else if (ratio < 33) { gBar.style.background = var(--warning); gMsg.className="info-card warning-bg"; gMsg.innerText="‚ö†Ô∏è Attention. Tu approches de la limite bancaire (33%)."; }
    else { gBar.style.background = var(--danger); gMsg.className="info-card danger-bg"; gMsg.innerText="üö® Risqu√© ! Ton endettement est trop √©lev√© pour ton salaire."; }

    // 3. Remboursement Anticip√©
    if (boost > 0) {
        const gain_mois = Math.round(n_base - n_new);
        const gain_argent = Math.round((m_base * n_base - P) - total_int_boosted);
        document.getElementById('boost-msg').innerText = `üöÄ Gain : -${gain_mois} mois et ${gain_argent}‚Ç¨ d'int√©r√™ts en moins !`;
    } else {
        document.getElementById('boost-msg').innerText = "";
    }

    updateChart(P, total_int_boosted, extra * n_new);
}

function updateChart(cap, int, fees) {
    const ctx = document.getElementById('mainChart').getContext('2d');
    if (chart) chart.destroy();
    chart = new Chart(ctx, {
        type: 'pie',
        data: {
            labels: ['Prix Objet', 'Int√©r√™ts', 'Assurance/Frais'],
            datasets: [{ data: [cap, int, fees], backgroundColor: ['#2563eb', '#ef4444', '#f59e0b'] }]
        },
        options: { maintainAspectRatio: false, plugins: { legend: { position: 'bottom' } } }
    });
}

run();
</script>
</body>
</html>
